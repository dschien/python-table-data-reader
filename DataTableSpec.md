# Data Table Specification

Columns can be in any order in the sheets, unless specified otherwise.

All dates must be the first of the month.

## Primary data sheets:

Any sheet with 'variable' in cell A1 is a primary data sheet. There must be at least one primary data sheet.

### Required columns:

- #### variable
  Variable must be the first column of each primary data sheet. It stores the internal names of the variables used.
  These names are referenced by the model .yml file. They must be unique.

  Any line where the variable cell is blank will
  be ignored, so can be used for comments.

- #### type
  Specifies the type of the variable. Must be one of:

  - exp:

    todo: Someone who understands the maths better than me please explain.

    Requires mean growth and ref date to be provided.

  - interp:

    Interpolates between / extrapolates from the provided ref values.

    Requires param to be provided. Changes expected format of ref value.

- #### param
  The type of interpolation to use. Ignored if type is not interp.

  todo: Linear works, not sure what else.

- #### ref value
  Provides a reference value for the parameter calculations. Must be a number.

  If the type is interp, the format should instead be `{"YYYY-MM-01":X, "YYYY-MM-01":Y}`, providing the start and end
  points of the interpolation. X and Y must be numbers.

- #### ref date
  The date at which the ref value was measured. Ignored if type is interp.

- #### mean growth
  todo: Used in the calculation of exp variables. Not sure how. Ignored if type is interp.

- #### initial_value_proportional_variation
  todo: Someone who understands the maths better than me please explain.

  Must be a number.

- #### variability growth
  todo: Someone who understands the maths better than me please explain.

  Must be a number.

- #### unit
  The unit of measurement of the variable. e.g. kg

- #### user name
  The name of the variable shown in the user interface.

- #### id
  The id of the variable. Used for the frontend to communicate with the server.

  Can be autogenerated using `todo: add a command for this`

- #### order
  The order that the variables are displayed in the user interface.

- #### ui variable
  Specifies how the variable is displayed in the user interface. Must be one of:
  - d:

    A decimal number.

  - p:

    A proportion.

  If left blank, the variable won't be shown in the user interface.

### Optional columns:

- #### label
  todo: Don't know what this is for.

- #### source
  The source of the data measurements.

- #### comment
  Any comments about the variable. Hidden from the user.

- #### control
  todo: Don't know what this is for.

- #### scenario notes
  todo: Don't know what this is for.

- #### description
  A description of the purpose of the variable, shown in the user interface.

- #### override
  todo: Not sure how this works.

## Group data sheets:

The name of the sheet must match the name of a variable in one of the primary data sheets.
Provides multiple values for that variable for different groups.

### Required columns:

- #### group
  The name of the group to provide values for.

- #### ref value
  See ref value for primary data sheets.

- #### initial_value_proportional_variation
  See initial_value_proportional_variation for primary data sheets.

- #### variability growth
  See variability growth for primary data sheets.

### Optional columns:

- #### mean growth
  See mean growth for primary data sheets.

## Metadata sheet:

There must be one sheet called 'metadata'.
It consists of key value pairs, with the keys in the first column and values in the second column.

### Keys:

- #### version
  The version number of the table.

- #### title
  The title of the table.

- #### author
  The author of the table.

  Multiple author keys can be used if there is more than one author.
